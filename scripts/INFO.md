# Code Overview
## Inputs
1. Road Network
   - Road centerlines are used to generate possible bus stop candidate locations.
   - Candidate points are sampled along the centerlines and filtered before optimization.

2. Land Use
   - Only the following land-use types are considered as demand sources:
       - Residential
       - Educational
       - Offices
       - Mixed-Use
   - Residential land use is given priority.
   - Ideally, each bus stop should serve at least 3 residential lots within the calculated walking distance.

3. Walking Distance
   - Walking time from a lot to a bus stop is estimated, not network-based.
   - Due to connectivity issues in the road centerline dataset, walking distance is derived from planar distance calculations.
   - As a result, walking time values should be treated as approximate rather than exact.

4. Population
   - Population is aggregated from lots assigned to each bus stop.
   - In an ideal scenario, a bus stop should serve high-density areas, defined here as:
       - More than 5,000 people within the calculated walking distance.
   - Lower-population stops are penalized during evaluation.

5. Bus Stop Placement Regulations (Assumptions)
     - A bus stop cannot be placed within an 18 m radius of a road intersection.
     - A bus stop must be at least 100 m apart from other bus stops.
  
## Genetic Algorithm Setup
The optimization uses NSGA-II to evolve candidate bus stop configurations. Each individual represents a fixed number of bus stops selected from pre-generated candidate points.

* Number of bus stops      : 50
* Candidate feature class : Lane4RoadPoints
* Minimum stop spacing    : 100 m
* Population size         : 40
* Number of generations   : 5
* Crossover probability   : 0.6
* Mutation probability    : 0.3

These values can be adjusted to explore alternative planning scenarios or performance trade-offs.

## Evaluation Components
1. Service Area Overlap Control
   - Pairwise overlap between bus stop service areas is calculated.
   - Low overlap is rewarded; medium and high overlap are penalized.
   - A normalized bonus prevents bias toward solutions with fewer stops.

2. Population Served per Stop
   - Population is summed from all lots assigned to each bus stop.
   - Very low-population stops receive penalties.
   - High-population stops receive higher rewards.

3. Walking Time Scoring
   - Each lot contributes a score and/or penalty based on walking time to its allocated stop.
   - Walking time is estimated using planar distances due to network limitations.

4. Duplicate Stop Handling
   - Duplicate bus stop locations may occur due to mutation or crossover.
   - Solutions containing duplicates are penalized.
   - Duplicate-free solutions receive a small bonus.

5. Residential Coverage Rule
   - Each bus stop is encouraged to serve at least three residential lots.
   - Stops meeting the requirement receive a bonus.
   - Stops failing to meet the requirement are penalized.
  
## Objective Outputs
The evaluation function returns the following objectives:
1. Total penalty            (minimize)
2. Overlap bonus            (maximize)
3. Population score         (maximize)
4. Walking time score       (maximize)
5. Duplicate-free score     (maximize)
6. Residential coverage     (maximize)

## Outputs Generated by the Code
  - Optimized bus stop point feature class
  - Lot-to-stop allocation lines
  - Summary metrics for population, walking time, and land-use coverage

All outputs are written back to ArcGIS Pro geodatabases for visualization and further analysis.
